<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Instagram Post Organizer</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- QR code scanner library -->
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript"></script>
</head>
<!-- Supabase JS CDN -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>

<body>
    <div class="max-w-4xl mx-auto p-4">
        <header id="mainHeader" class="flex flex-col sm:flex-row items-center justify-between mb-6">
            <h1 class="text-3xl font-bold mb-2 sm:mb-0">Instagram Post Organizer</h1>
            <button id="addPostBtn"
                class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow">Add New
                Post</button>
        </header>

        <div class="overflow-x-auto bg-white rounded-lg shadow mb-8">
            <table class="min-w-full divide-y divide-gray-200">
                <thead class="bg-gray-100">
                    <tr>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">ID
                        </th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Image
                        </th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Post
                            Description</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Status</th>
                        <th class="px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                            Actions</th>
                    </tr>
                </thead>
                <tbody id="postsTableBody" class="bg-white divide-y divide-gray-200">
                    <!-- Posts will be dynamically added here -->
                </tbody>
            </table>
        </div>

        <!-- Add/Edit Post Modal -->
        <div id="postModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 hidden">
            <div class="bg-white rounded-lg shadow-lg w-full max-w-lg p-6 relative">
                <span id="modalClose"
                    class="absolute top-4 right-4 text-2xl text-gray-400 hover:text-gray-700 cursor-pointer">&times;</span>
                <h2 id="modalTitle" class="text-xl font-semibold mb-4">Add New Post</h2>
                <form id="postForm" class="space-y-4">
                    <input type="hidden" id="postId">
                    <div class="mb-4">
                        <label for="postImages" class="block text-sm font-medium text-gray-700 mb-1">Post
                            Images:</label>
                        <input type="file" id="postImages" accept="image/*" multiple
                            class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                        <div id="imagePreview" class="flex flex-wrap gap-2 mt-2"></div>
                    </div>
                    <div class="mb-4">
                        <label for="postDescription" class="block text-sm font-medium text-gray-700 mb-1">Post
                            Description:</label>
                        <textarea id="postDescription" rows="4" required
                            placeholder="Enter your Instagram post description..."
                            class="block w-full border border-gray-300 rounded p-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
                    </div>
                    <div class="mb-4">
                        <label for="postStatus" class="block text-sm font-medium text-gray-700 mb-1">Status:</label>
                        <select id="postStatus"
                            class="block w-full border border-gray-300 rounded p-2 focus:ring-blue-500 focus:border-blue-500">
                            <option value="pending">Pending</option>
                            <option value="approved">Approved</option>
                            <option value="rejected">Rejected</option>
                        </select>
                    </div>
                    <div class="flex justify-end gap-2">
                        <button type="submit"
                            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded shadow">Save
                            Post</button>
                        <button type="button"
                            class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded shadow"
                            onclick="closeModal()">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>

        // Show QR modal for creds if not present in localStorage
        function ensureCredsWithQR(onReady) {
            if (localStorage.getItem('creds')) {
                onReady();
                return;
            }

            // Create modal
            const modal = document.createElement('div');
            modal.id = 'qr-creds-modal';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100vw';
            modal.style.height = '100vh';
            modal.style.background = 'rgba(0,0,0,0.35)';
            modal.style.display = 'flex';
            modal.style.alignItems = 'center';
            modal.style.justifyContent = 'center';
            modal.style.zIndex = '99999';

            const box = document.createElement('div');
            box.style.background = '#fff';
            box.style.padding = '2.5em 2em 2em 2em';
            box.style.borderRadius = '12px';
            box.style.boxShadow = '0 4px 32px rgba(0,0,0,0.13)';
            box.style.minWidth = '340px';
            box.style.textAlign = 'center';

            const title = document.createElement('h2');
            title.textContent = 'Scan or Upload QR for Credentials';
            title.style.marginBottom = '1em';
            title.style.fontWeight = '600';
            title.style.fontSize = '1.3em';

            const errorMsg = document.createElement('div');
            errorMsg.style.color = '#c00';
            errorMsg.style.fontSize = '0.95em';
            errorMsg.style.margin = '0.5em 0 0.5em 0';
            errorMsg.style.display = 'none';

            // QR scanner container
            const qrContainer = document.createElement('div');
            qrContainer.id = 'qr-reader';
            qrContainer.style.margin = '1em auto';
            qrContainer.style.width = '260px';
            qrContainer.style.height = '260px';

            // Buttons
            const webcamBtn = document.createElement('button');
            webcamBtn.textContent = 'Scan with Webcam';
            webcamBtn.className = 'btn primary';
            webcamBtn.style.margin = '0.5em';

            const uploadBtn = document.createElement('button');
            uploadBtn.textContent = 'Upload QR Image';
            uploadBtn.className = 'btn secondary';
            uploadBtn.style.margin = '0.5em';

            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = 'image/*';
            fileInput.style.display = 'none';

            let html5QrCode = null;
            let scanning = false;

            function handleDecoded(decodedText) {
                try {
                    const credsObj = JSON.parse(decodedText);
                    localStorage.setItem('creds', JSON.stringify(credsObj));
                    document.body.removeChild(modal);
                    onReady();
                } catch (e) {
                    errorMsg.textContent = 'Invalid QR: not a valid JSON string.';
                    errorMsg.style.display = 'block';
                }
            }

            webcamBtn.onclick = () => {
                errorMsg.style.display = 'none';
                if (html5QrCode) {
                    html5QrCode.stop().then(() => {
                        html5QrCode.clear();
                        startWebcam();
                    });
                } else {
                    startWebcam();
                }
            };

            function startWebcam() {
                qrContainer.innerHTML = '';
                html5QrCode = new Html5Qrcode('qr-reader');
                scanning = true;
                html5QrCode.start(
                    { facingMode: 'environment' },
                    { fps: 10, qrbox: { width: 220, height: 220 } },
                    (decodedText) => {
                        if (scanning) {
                            scanning = false;
                            html5QrCode.stop().then(() => html5QrCode.clear());
                            handleDecoded(decodedText);
                        }
                    },
                    (errorMessage) => {
                        // ignore scan errors
                    }
                ).catch((err) => {
                    errorMsg.textContent = 'Camera error: ' + err;
                    errorMsg.style.display = 'block';
                });
            }

            uploadBtn.onclick = () => {
                errorMsg.style.display = 'none';
                fileInput.value = '';
                fileInput.click();
            };

            fileInput.onchange = (e) => {
                if (!e.target.files.length) return;
                const imageFile = e.target.files[0];
                if (html5QrCode) {
                    html5QrCode.clear();
                } else {
                    html5QrCode = new Html5Qrcode('qr-reader');
                }
                scanning = false;
                html5QrCode.scanFile(imageFile, true)
                    .then(decodedText => {
                        handleDecoded(decodedText);
                    })
                    .catch(err => {
                        errorMsg.textContent = 'Could not read QR from image.';
                        errorMsg.style.display = 'block';
                    });
            };

            box.appendChild(title);
            box.appendChild(errorMsg);
            box.appendChild(webcamBtn);
            box.appendChild(uploadBtn);
            box.appendChild(fileInput);
            box.appendChild(qrContainer);
            modal.appendChild(box);
            document.body.appendChild(modal);
        }

        // Load credentials from localStorage
        function getCreds() {
            const credsStr = localStorage.getItem('creds');
            if (!credsStr) throw new Error('Missing credentials in localStorage under key "creds"');
            try {
                return JSON.parse(credsStr);
            } catch (e) {
                throw new Error('Invalid JSON in creds localStorage');
            }
        }

        function initApp() {
            const creds = getCreds();
            window.creds = creds;
            const SUPABASE_URL = creds.supabase.url;
            const SUPABASE_KEY = creds.supabase.key;
            window.supabase = window.supabase || {};
            window.supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
            // ...existing code...
            window.organizer = new PostOrganizer();
        }

        // Instagram Post Organizer JavaScript with Multiple Image Support

        // Patch: Use window.supabaseClient instead of supabase
        class PostOrganizer {
            constructor() {
                this.posts = [];
                this.currentImages = [];
                this.currentPage = 1;
                this.pageSize = 10;
                this.totalPosts = 0;
                this.init();
            }

            async init() {
                this.bindEvents();
                await this.loadPosts();
                this.renderPosts();
            }

            bindEvents() {
                document.getElementById('addPostBtn').addEventListener('click', () => this.openModal());
                document.getElementById('modalClose').addEventListener('click', () => this.closeModal());
                window.addEventListener('click', (e) => {
                    if (e.target === document.getElementById('postModal')) {
                        this.closeModal();
                    }
                });
                document.getElementById('postForm').addEventListener('submit', (e) => this.handleFormSubmit(e));
                document.getElementById('postImages').addEventListener('change', (e) => this.handleMultipleImageUpload(e));
                // Pagination controls
                document.addEventListener('click', (e) => {
                    if (e.target && e.target.id === 'prevPageBtn') {
                        this.prevPage();
                    }
                    if (e.target && e.target.id === 'nextPageBtn') {
                        this.nextPage();
                    }
                });
            }

            async loadPosts() {
                // Get total count for pagination
                const { count, error: countError } = await window.supabaseClient
                    .from('posts')
                    .select('*', { count: 'exact', head: true });
                if (countError) {
                    this.totalPosts = 0;
                } else {
                    this.totalPosts = count || 0;
                }
                // Calculate range for current page
                const from = (this.currentPage - 1) * this.pageSize;
                const to = from + this.pageSize - 1;
                // Fetch paginated posts
                const { data, error } = await window.supabaseClient
                    .from('posts')
                    .select('*')
                    .order('id', { ascending: true })
                    .range(from, to);
                if (error) {
                    alert('Failed to load posts from Supabase.');
                    this.posts = [];
                } else {
                    this.posts = data || [];
                }
            }
            prevPage() {
                if (this.currentPage > 1) {
                    this.currentPage--;
                    this.loadPosts().then(() => this.renderPosts());
                }
            }

            nextPage() {
                const maxPage = Math.ceil(this.totalPosts / this.pageSize);
                if (this.currentPage < maxPage) {
                    this.currentPage++;
                    this.loadPosts().then(() => this.renderPosts());
                }
            }

            async handleMultipleImageUpload(e) {
                const files = Array.from(e.target.files);
                const previewContainer = document.getElementById('imagePreview');
                for (const file of files) {
                    if (file && file.type.startsWith('image/')) {
                        // Show uploading placeholder
                        this.currentImages.push({ uploading: true });
                        this.renderImagePreview();
                        try {
                            const url = await this.uploadToImgBB(file);
                            // Replace the placeholder with the real URL
                            const idx = this.currentImages.findIndex(img => img.uploading);
                            if (idx !== -1) {
                                this.currentImages[idx] = url;
                            }
                        } catch (err) {
                            alert('Failed to upload image to ImgBB.');
                            // Remove the placeholder
                            const idx = this.currentImages.findIndex(img => img.uploading);
                            if (idx !== -1) {
                                this.currentImages.splice(idx, 1);
                            }
                        }
                        this.renderImagePreview();
                    }
                }
                // Clear the file input to allow re-uploading the same files
                e.target.value = '';
            }

            async uploadToImgBB(file) {
                const apiKey = creds.imgbb.apiKey;
                const formData = new FormData();
                formData.append('key', apiKey);
                formData.append('image', file);
                const response = await fetch('https://api.imgbb.com/1/upload', {
                    method: 'POST',
                    body: formData
                });
                const data = await response.json();
                if (data && data.success && data.data && data.data.url) {
                    return data.data.url;
                } else {
                    throw new Error('ImgBB upload failed');
                }
            }

            renderImagePreview() {
                const previewContainer = document.getElementById('imagePreview');
                previewContainer.innerHTML = '';
                this.currentImages.forEach((imageData, index) => {
                    const previewItem = document.createElement('div');
                    previewItem.className = 'relative inline-block mr-2 mb-2';
                    if (typeof imageData === 'string') {
                        previewItem.innerHTML = `
                    <img src="${imageData}" alt="Preview ${index + 1}" class="w-20 h-20 object-cover rounded border border-gray-200 shadow-sm">
                    <button type="button" class="absolute top-0 right-0 bg-white bg-opacity-80 text-gray-700 rounded-full w-6 h-6 flex items-center justify-center text-lg font-bold shadow hover:bg-red-100" style="transform: translate(40%,-40%);" onclick="organizer.removeImage(${index})">×</button>
                `;
                    } else if (imageData.uploading) {
                        previewItem.innerHTML = `
                    <div class="w-20 h-20 flex items-center justify-center bg-gray-100 text-gray-400 rounded border border-gray-200">Uploading...</div>
                `;
                    }
                    previewContainer.appendChild(previewItem);
                });
            }

            removeImage(index) {
                this.currentImages.splice(index, 1);
                this.renderImagePreview();
            }

            openModal(post = null) {
                const modal = document.getElementById('postModal');
                const form = document.getElementById('postForm');
                const title = document.getElementById('modalTitle');

                if (post) {
                    title.textContent = 'Edit Post';
                    document.getElementById('postId').value = post.id;
                    document.getElementById('postDescription').value = post.description;
                    document.getElementById('postStatus').value = post.status;

                    // Load existing images
                    this.currentImages = post.images || [];
                    this.renderImagePreview();
                } else {
                    title.textContent = 'Add New Post';
                    form.reset();
                    document.getElementById('postId').value = '';
                    this.currentImages = [];
                    this.renderImagePreview();
                }

                modal.classList.remove('hidden');
            }

            closeModal() {
                const modal = document.getElementById('postModal');
                modal.classList.add('hidden');
                document.getElementById('postForm').reset();
                this.currentImages = [];
                document.getElementById('imagePreview').innerHTML = '';
            }


            async handleFormSubmit(e) {
                e.preventDefault();
                const id = document.getElementById('postId').value;
                const description = document.getElementById('postDescription').value.trim();
                const status = document.getElementById('postStatus').value;
                if (!description) {
                    alert('Please enter a post description');
                    return;
                }
                if (id) {
                    // Edit existing post in Supabase
                    const { error } = await window.supabaseClient
                        .from('posts')
                        .update({
                            description,
                            status,
                            images: this.currentImages,
                            updated_at: new Date().toISOString()
                        })
                        .eq('id', parseInt(id));
                    if (error) {
                        alert('Failed to update post in Supabase.');
                        return;
                    }
                    // Update local array instead of reloading all posts
                    const post = this.posts.find(p => p.id === parseInt(id));
                    if (post) {
                        post.description = description;
                        post.status = status;
                        post.images = this.currentImages;
                        post.updated_at = new Date().toISOString();
                    }
                } else {
                    // Add new post to Supabase - get the created post back
                    const { data, error } = await window.supabaseClient
                        .from('posts')
                        .insert({
                            description,
                            status,
                            images: this.currentImages,
                            created_at: new Date().toISOString(),
                            updated_at: new Date().toISOString()
                        })
                        .select();
                    if (error) {
                        alert('Failed to add post to Supabase.');
                        return;
                    }
                    // Add to local array instead of reloading all posts
                    if (data && data[0]) {
                        this.posts.push(data[0]);
                        this.totalPosts++;
                    }
                }
                this.renderPosts();
                this.closeModal();
            }


            editPost(id) {
                const post = this.posts.find(p => p.id === id);
                if (post) {
                    this.openModal(post);
                }
            }


            async deletePost(id) {
                if (confirm('Are you sure you want to delete this post?')) {
                    const { error } = await window.supabaseClient
                        .from('posts')
                        .delete()
                        .eq('id', id);
                    if (error) {
                        alert('Failed to delete post from Supabase.');
                        return;
                    }
                    // Remove from local array instead of reloading all posts
                    this.posts = this.posts.filter(post => post.id !== id);
                    this.totalPosts--;
                    this.renderPosts();
                }
            }


            async toggleStatus(id, newStatus) {
                const { error } = await window.supabaseClient
                    .from('posts')
                    .update({
                        status: newStatus,
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', id);
                if (error) {
                    alert('Failed to update status in Supabase.');
                    return;
                }
                // Update local array instead of reloading all posts
                const post = this.posts.find(p => p.id === id);
                if (post) {
                    post.status = newStatus;
                    post.updated_at = new Date().toISOString();
                }
                this.renderPosts();
            }


            renderPosts() {
                const tbody = document.getElementById('postsTableBody');
                tbody.innerHTML = '';
                if (this.posts.length === 0) {
                    tbody.innerHTML = `
                <tr>
                    <td colspan="5" class="empty-state">
                        <h3>No posts yet</h3>
                        <p>Click \"Add New Post\" to get started</p>
                    </td>
                </tr>
            `;
                } else {
                    this.posts.forEach(post => {
                        const row = document.createElement('tr');
                        let imagesHtml = '<span class="text-gray-400">No images</span>';
                        if (post.images && post.images.length > 0) {
                            const displayCount = Math.min(4, post.images.length);
                            imagesHtml = '<div class="flex flex-wrap gap-1 items-center">';
                            for (let i = 0; i < displayCount; i++) {
                                imagesHtml += `<img src="${post.images[i]}" alt="Image ${i + 1}" class="w-16 h-16 object-cover rounded border border-gray-200">`;
                            }
                            if (post.images.length > 4) {
                                imagesHtml += `<div class="ml-2 text-xs text-gray-500 font-semibold">+${post.images.length - 4} more</div>`;
                            }
                            imagesHtml += '</div>';
                        }
                        // Beautified action buttons with icons and spacing
                        row.innerHTML = `
                    <td>${post.id}</td>
                    <td class="post-images-cell">${imagesHtml}</td>
                    <td class="post-description">${post.description}</td>
                    <td>
                        <span class="status-badge ${post.status}">${post.status}</span>
                    </td>
                    <td class="actions">
                        <div class="flex gap-2">
                            <button class="inline-flex items-center gap-1 px-3 py-1 rounded bg-blue-500 hover:bg-blue-600 text-white text-xs font-semibold shadow transition" title="Edit" onclick="organizer.editPost(${post.id})">
                                <svg xmlns='http://www.w3.org/2000/svg' class='h-4 w-4' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15.232 5.232l3.536 3.536M9 13l6.536-6.536a2 2 0 112.828 2.828L11.828 15.828a2 2 0 01-2.828 0L5 11.828a2 2 0 010-2.828L9 13z' /></svg>
                                Edit
                            </button>
                            <button class="inline-flex items-center gap-1 px-3 py-1 rounded ${post.status === 'approved' ? 'bg-yellow-400 hover:bg-yellow-500 text-gray-900' : 'bg-green-500 hover:bg-green-600 text-white'} text-xs font-semibold shadow transition" title="${post.status === 'approved' ? 'Unapprove' : 'Approve'}" onclick="organizer.toggleStatus(${post.id}, '${post.status === 'approved' ? 'pending' : 'approved'}')">
                                ${post.status === 'approved'
                                ? `<svg xmlns='http://www.w3.org/2000/svg' class='h-4 w-4' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12' /></svg>Unapprove`
                                : `<svg xmlns='http://www.w3.org/2000/svg' class='h-4 w-4' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 13l4 4L19 7' /></svg>Approve`
                            }
                            </button>
                            <button class="inline-flex items-center gap-1 px-3 py-1 rounded bg-red-500 hover:bg-red-600 text-white text-xs font-semibold shadow transition" title="Delete" onclick="organizer.deletePost(${post.id})">
                                <svg xmlns='http://www.w3.org/2000/svg' class='h-4 w-4' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12' /></svg>
                                Delete
                            </button>
                        </div>
                    </td>
                `;
                        tbody.appendChild(row);
                    });
                }
                // Pagination controls
                const maxPage = Math.max(1, Math.ceil(this.totalPosts / this.pageSize));
                const paginationRow = document.createElement('tr');
                paginationRow.innerHTML = `
            <td colspan="5" class="py-2 text-center">
                <button id="prevPageBtn" class="btn small" ${this.currentPage === 1 ? 'disabled' : ''}>Prev</button>
                <span class="mx-2">Page ${this.currentPage} of ${maxPage}</span>
                <button id="nextPageBtn" class="btn small" ${this.currentPage === maxPage ? 'disabled' : ''}>Next</button>
            </td>
        `;
                tbody.appendChild(paginationRow);
            }


            // Export functionality
            async exportPosts() {
                // Fetch all posts from Supabase and export as JSON
                const { data, error } = await window.supabaseClient
                    .from('posts')
                    .select('*')
                    .order('id', { ascending: true });
                if (error) {
                    alert('Failed to export posts from Supabase.');
                    return;
                }
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'instagram-posts.json';
                link.click();
            }

            // Import functionality
            async importPosts(file) {
                const reader = new FileReader();
                reader.onload = async (e) => {
                    try {
                        const importedPosts = JSON.parse(e.target.result);
                        if (Array.isArray(importedPosts)) {
                            // Remove id/created_at/updated_at to avoid conflicts
                            const cleanPosts = importedPosts.map(p => ({
                                description: p.description,
                                status: p.status,
                                images: p.images || [],
                                created_at: new Date().toISOString(),
                                updated_at: new Date().toISOString()
                            }));
                            const { error } = await window.supabaseClient
                                .from('posts')
                                .insert(cleanPosts);
                            if (error) {
                                alert('Failed to import posts to Supabase.');
                                return;
                            }
                            await this.loadPosts();
                            this.renderPosts();
                            alert('Posts imported successfully!');
                        }
                    } catch (error) {
                        alert('Error importing posts. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            }
        }


        // Initialize the app only after creds are set
        ensureCredsWithQR(initApp);

        // Add export/import buttons
        document.addEventListener('DOMContentLoaded', () => {
            const header = document.getElementById('mainHeader');
            // Create export button
            const exportBtn = document.createElement('button');
            exportBtn.textContent = 'Export Posts';
            exportBtn.className = 'btn secondary';
            exportBtn.onclick = () => organizer.exportPosts();
            // Create import button
            const importBtn = document.createElement('button');
            importBtn.textContent = 'Import Posts';
            importBtn.className = 'btn secondary';
            // Create hidden file input
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json';
            fileInput.style.display = 'none';
            fileInput.onchange = (e) => {
                if (e.target.files[0]) {
                    organizer.importPosts(e.target.files[0]);
                }
            };
            importBtn.onclick = () => fileInput.click();
            // Add buttons to header
            header.appendChild(exportBtn);
            header.appendChild(importBtn);
            header.appendChild(fileInput);
        });

        // Keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.key === 'n') {
                e.preventDefault();
                organizer.openModal();
            }
            if (e.key === 'Escape') {
                organizer.closeModal();
            }
        });

    </script>
</body>

</html>